<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"></meta>
    <meta name="description" content="A simple maze editor"></meta>
    <meta name="viewport" content="width=device-width"></meta>
    <title>Maze Editor</title>
  </head>
  <body>

    <h1>Maze Editor</h1>

    <ul id="maze">
    </ul>

    <template id="maze-template">
        <h2 class="name"></h2>
        <div class="details"></div>
    </template>

    <script>
        const mazeId = location.pathname.match(/maze\/([^\/]*)\/?/)[1];
        const template = document.getElementById('maze-template');
        const wrapper = document.getElementById('maze');

        const xhr = new XMLHttpRequest();
        xhr.addEventListener('load', function () {

            // TODO - handle errors
            const maze = JSON.parse(this.responseText);

            const node = document.importNode(template.content, true);

            // TODO - Don't set HTML straight from database
            node.querySelector('.name').innerHTML = maze.name;
            node.querySelector('.details').innerHTML = JSON.stringify(maze);

            wrapper.appendChild(node);
        });

        xhr.open("GET", `http://localhost:3000/maze/${mazeId}/`);
        xhr.send();
    </script>

  </body>
</html>
